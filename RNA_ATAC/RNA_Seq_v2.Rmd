---
title: "RNA_seq"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
countData=read.csv('gene_count_matrix.csv', header=TRUE,as.is = TRUE)
head(countData)
```

```{r}
countData$gene_id=unlist(lapply(strsplit(countData$gene_id, '|', fixed = TRUE), '[', 2))
 
countData=na.omit(countData)

rownames(countData) = make.names(countData[,1],unique=TRUE)
countData=countData[,-1]
```

```{r}
columns=c("SEDM_2P_1","SEDM_2P_2","SEDM_2P_3","SEEM_2P_1","SEEM_2P_2","SEEM_2P_3","SEEM_4P_1","SEEM_4P_2","SEEM_4P_3","PERKi_1","PERKi_2","PERKi_3","T_1","T_2","T_3")
```


```{r}
colnames(countData)=columns
colSums(countData)
barplot(colSums(countData),las=3)
```

```{r}
hist(countData$SEDM_2P_1,br=100)
```
```{r}
logCountData=log2(1+countData)
hist(logCountData$SEDM_2P_1,br=100)
```

```{r}
plot(logCountData[,1],logCountData[,2])
```
```{r}
treatment=c("F0","F0","F0","F1","F1","F1","F2","F2","F2","F3","F3","F3","F4","F4","F4")
inh=c(rep("U",9),"I", "I","I",rep("U",3))
colData=as.data.frame(cbind(colnames(countData), inh, treatment))
```

```{r}
dds=DESeqDataSetFromMatrix(countData = countData, colData =  colData, design= ~treatment)
DESeq(dds)

```


```{r}
dds= dds[rowSums(counts(dds))>5,]
nrow(dds)
```
```{r}
library(ggplot2)
rld=rlog(dds)
plotPCA(rld, intgroup= "treatment")
```